(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";(function(){function r(t){const n=t.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(n))}const o=document.currentScript,i=r((o==null?void 0:o.src)||""),u=i.projectId,p=i.ty,a=i.payload,m="https://shipwait.vercel.app";if(!u){console.warn("[Waitly] Missing projectId in script src query params.");return}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("input[data-shipwait]");if(!t){console.warn("[Waitly] No input with [data-shipwait] attribute found.");return}const n=t.closest("form");if(!n){console.warn("[Waitly] The input with [data-shipwait] is not inside a <form>.");return}const c=document.querySelector("p[data-shipwait-message], div[data-shipwait-message]");function d(s){c?(c.textContent=s,c.style.display="block"):alert(s)}n.addEventListener("submit",async s=>{s.preventDefault();const f=t.value.trim();if(!f){d("Please enter your email.");return}try{const e=await fetch(`${m}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,projectId:u})});if(!e.ok){let l;try{l=await e.json()}catch{l={message:await e.text()}}const w=l.message+"."||"Server error";throw new Error(w)}const y=await e.text();if(console.log("[Waitly] Lead added:",y),p==="redirect"&&a){window.location.href=a;return}p==="message"&&a&&d(a),t.value=""}catch(e){console.error("[Waitly] Submission error:",e),d(e.message||"Server error")}})})})()});
