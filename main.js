(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";(function(){var d;const r=(d=document.currentScript)==null?void 0:d.getAttribute("data-shipwait-id"),u="https://shipwait.vercel.app";if(!r){console.warn("[Shipwait] Missing projectId in script src query params.");return}async function w(){try{const t=await fetch(`${u}/api/submission-behaviors?projectId=${r}`);return t.ok?(await t.json()).data:(console.warn(`[Shipwait] Failed to fetch behaviors: ${t.status}`),null)}catch(t){return console.warn("[Shipwait] Error fetching behaviors:",t),null}}document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector("input[data-shipwait]");if(!t){console.warn("[Shipwait] No input with [data-shipwait] attribute found.");return}const o=t.closest("form");if(!o){console.warn("[Shipwait] The input with [data-shipwait] is not inside a <form>.");return}const p=document.querySelector("[data-shipwait-message]");function s(a){p?p.textContent=a:alert(a)}o.addEventListener("submit",async a=>{a.preventDefault();const l=t.value.trim();if(!l){s("Please enter your email.");return}const n=await w(),h=(n==null?void 0:n.type)||"do_nothing",i=(n==null?void 0:n.payload)||null;try{const e=await fetch(`${u}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l,projectId:r})});if(!e.ok){let c;try{c=await e.json()}catch{c={message:await e.text()}}const m=c.message+"."||"Server error";throw new Error(m)}const f=await e.text();if(console.log("[Shipwait] Lead added:",f),h==="redirect"&&i){window.location.href=i;return}h==="show_message"&&i&&s(i),t.value=""}catch(e){console.error("[Shipwait] Submission error:",e),s(e.message||"Server error")}})})})()});
