(function(o){typeof define=="function"&&define.amd?define(o):o()})(function(){"use strict";(function(){function o(t){const r=t.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(r))}const c=document.currentScript,u=o((c==null?void 0:c.src)||"").id;if(!u){console.warn("[Shipwait] Missing projectId in script!");return}const p="https://shipwait.vercel.app";async function g(){try{const t=await fetch(`${p}/api/submission-behaviors?projectId=${u}`);return t.ok?(await t.json()).data:null}catch{return null}}document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector("input[data-shipwait]");if(!t)return;const r=t.closest("form");if(!r)return;const m=document.querySelector("[data-shipwait-message]"),s=r.querySelector("button[type='submit']"),y=s?s.textContent:"Submit";function l(n){m?m.textContent=n:alert(n)}function h(n){t.disabled=n,s&&(s.disabled=n,s.textContent=n?`${y}...`:y)}r.addEventListener("submit",async n=>{n.preventDefault();const w=t.value.trim();if(!w){l("Please enter your email.");return}h(!0);try{const e=await g(),d=(e==null?void 0:e.behavior_type)||"do_nothing",a=d==="redirect"?e==null?void 0:e.redirect:(e==null?void 0:e.message)||null,i=await fetch(`${p}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:w,projectId:u})});if(!i.ok){let f;try{f=await i.json()}catch{f={message:await i.text()}}const S=f.message+"."||"Server error";throw new Error(S)}if(await i.text(),d==="redirect"&&a){window.location.href=a;return}d==="show_message"&&a&&l(a),t.value=""}catch(e){l(e.message||"Server error")}finally{h(!1)}})})})()});
