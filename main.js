(function(i){typeof define=="function"&&define.amd?define(i):i()})(function(){"use strict";(function(){const i=document.currentScript||Array.from(document.querySelectorAll("script")).find(t=>{var r;return((r=t.src)==null?void 0:r.includes("shipwait-script-dist"))&&t.hasAttribute("data-shipwait-id")}),s=i==null?void 0:i.getAttribute("data-shipwait-id"),u="https://shipwait.vercel.app";if(!s){console.warn("[Shipwait] Missing projectId in script.");return}async function w(){try{const t=await fetch(`${u}/api/submission-behaviors?projectId=${s}`);return t.ok?(await t.json()).data:(console.warn(`[Shipwait] Failed to fetch behaviors: ${t.status}`),null)}catch(t){return console.warn("[Shipwait] Error fetching behaviors:",t),null}}document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector("input[data-shipwait]");if(!t){console.warn("[Shipwait] No input with [data-shipwait] attribute found.");return}const r=t.closest("form");if(!r){console.warn("[Shipwait] The input with [data-shipwait] is not inside a <form>.");return}const l=document.querySelector("[data-shipwait-message]");function c(a){l?l.textContent=a:alert(a)}r.addEventListener("submit",async a=>{a.preventDefault();const p=t.value.trim();if(!p){c("Please enter your email.");return}const n=await w(),h=(n==null?void 0:n.type)||"do_nothing",o=(n==null?void 0:n.payload)||null;try{const e=await fetch(`${u}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p,projectId:s})});if(!e.ok){let d;try{d=await e.json()}catch{d={message:await e.text()}}const m=d.message+"."||"Server error";throw new Error(m)}const f=await e.text();if(console.log("[Shipwait] Lead added:",f),h==="redirect"&&o){window.location.href=o;return}h==="show_message"&&o&&c(o),t.value=""}catch(e){console.error("[Shipwait] Submission error:",e),c(e.message||"Server error")}})})})()});
