(function(i){typeof define=="function"&&define.amd?define(i):i()})(function(){"use strict";(function(){window.addEventListener("shipwait:init",initializeForm);function i(t){const r=t.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(r))}const c=document.currentScript,u=i((c==null?void 0:c.src)||"").id;if(od,!u){console.warn("[Shipwait] Missing projectId in script!");return}const m="https://www.shipwait.com";async function g(){try{const t=await fetch(`${m}/api/submission-behaviors?projectId=${u}`);return t.ok?(await t.json()).data:null}catch{return null}}document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector("input[data-shipwait]");if(!t)return;const r=t.closest("form");if(!r)return;const p=document.querySelector("[data-shipwait-message]"),s=r.querySelector("button[type='submit']"),w=s?s.textContent:"Submit";function d(n){p?p.textContent=n:alert(n)}function h(n){t.disabled=n,s&&(s.disabled=n,s.textContent=n?`${w}...`:w)}r.addEventListener("submit",async n=>{n.preventDefault();const y=t.value.trim();if(!y){d("Please enter your email.");return}h(!0);try{const e=await g(),l=(e==null?void 0:e.behavior_type)||"do_nothing",o=l==="redirect"?e==null?void 0:e.redirect:(e==null?void 0:e.message)||null,a=await fetch(`${m}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:y,projectId:u})});if(!a.ok){let f;try{f=await a.json()}catch{f={message:await a.text()}}const S=f.message+"."||"Server error";throw new Error(S)}if(await a.text(),l==="redirect"&&o){window.location.href=o;return}l==="show_message"&&o&&d(o),t.value=""}catch(e){d(e.message||"Server error")}finally{h(!1)}})})})()});
