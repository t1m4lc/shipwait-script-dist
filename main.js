(function(s){typeof define=="function"&&define.amd?define(s):s()})(function(){"use strict";(function(){function s(e){const n=e.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(n))}const i=document.currentScript,c=s((i==null?void 0:i.src)||"").id,l="https://shipwait.vercel.app";if(!c){console.warn("[Shipwait] Missing projectId in script!");return}async function h(){try{const e=await fetch(`${l}/api/submission-behaviors?projectId=${c}`);return e.ok?(await e.json()).data:null}catch{return null}}document.addEventListener("DOMContentLoaded",async()=>{const e=document.querySelector("input[data-shipwait]");if(!e)return;const n=e.closest("form");if(!n)return;const f=document.querySelector("[data-shipwait-message]");function u(a){f?f.textContent=a:alert(a)}n.addEventListener("submit",async a=>{a.preventDefault();const p=e.value.trim();if(!p){u("Please enter your email.");return}const t=await h(),m=(t==null?void 0:t.type)||"do_nothing",o=(t==null?void 0:t.payload)||null;try{const r=await fetch(`${l}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p,projectId:c})});if(!r.ok){let d;try{d=await r.json()}catch{d={message:await r.text()}}const w=d.message+"."||"Server error";throw new Error(w)}if(await r.text(),m==="redirect"&&o){window.location.href=o;return}m==="show_message"&&o&&u(o),e.value=""}catch(r){u(r.message||"Server error")}})})})()});
