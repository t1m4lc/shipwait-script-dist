(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";(function(){function r(t){const n=t.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(n))}const s=document.currentScript,i=r((s==null?void 0:s.src)||""),u=i.projectId,y=i.ty,a=i.payload,p="https://shipwait.vercel.app";if(!u){console.warn("[Waitly] Missing projectId in script src query params.");return}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("input[data-waitly]");if(!t){console.warn("[Waitly] No input with [data-waitly] attribute found.");return}const n=t.closest("form");if(!n){console.warn("[Waitly] The input with [data-waitly] is not inside a <form>.");return}const c=document.querySelector("p[data-waitly-message], div[data-waitly-message]");function l(o){c?(c.textContent=o,c.style.display="block"):alert(o)}n.addEventListener("submit",async o=>{o.preventDefault();const f=t.value.trim();if(!f){l("Please enter your email.");return}try{const e=await fetch(`${p}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,projectId:u})});if(!e.ok){let d;try{d=await e.json()}catch{d={message:await e.text()}}const w=d.message+"."||"Server error";throw new Error(w)}const m=await e.text();if(console.log("[Waitly] Lead added:",m),y==="redirect"&&a){window.location.href=a;return}y==="message"&&a&&l(a),t.value=""}catch(e){console.error("[Waitly] Submission error:",e),l(e.message||"Server error")}})})})()});
