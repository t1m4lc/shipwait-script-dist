(function(r){typeof define=="function"&&define.amd?define(r):r()})(function(){"use strict";(function(){function r(t){const a=t.split("?")[1]||"";return Object.fromEntries(new URLSearchParams(a))}const i=document.currentScript,s=r((i==null?void 0:i.src)||""),u=s.projectId,p=s.ty,n=s.payload,w="https://shipwait.vercel.app";if(!u){console.warn("[Shipwait] Missing projectId in script src query params.");return}document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("input[data-shipwait]");if(!t){console.warn("[Shipwait] No input with [data-shipwait] attribute found.");return}const a=t.closest("form");if(!a){console.warn("[Shipwait] The input with [data-shipwait] is not inside a <form>.");return}const l=document.querySelector("[data-shipwait-message]");function c(o){l?l.textContent=o:alert(o)}a.addEventListener("submit",async o=>{o.preventDefault();const f=t.value.trim();if(!f){c("Please enter your email.");return}try{const e=await fetch(`${w}/api/leads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:f,projectId:u})});if(!e.ok){let d;try{d=await e.json()}catch{d={message:await e.text()}}const m=d.message+"."||"Server error";throw new Error(m)}const h=await e.text();if(console.log("[Shipwait] Lead added:",h),p==="redirect"&&n){window.location.href=n;return}p==="show_message"&&n&&c(n),t.value=""}catch(e){console.error("[Shipwait] Submission error:",e),c(e.message||"Server error")}})})})()});
